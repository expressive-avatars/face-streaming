var C=Object.defineProperty;var v=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var g=(t,e,n)=>e in t?C(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,y=(t,e)=>{for(var n in e||(e={}))L.call(e,n)&&g(t,n,e[n]);if(v)for(var n of v(e))R.call(e,n)&&g(t,n,e[n]);return t};import{j as r,u as b,c as F,r as l,a as w,l as x,M as d,b as c,Q as A,A as D,d as M,C as I,O as T,E as j,e as q,R as H,f as P,H as N,S as W,g as m,L as S}from"./vendor.42d3f552.js";const z=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}};z();function B(t){return r("div",y({style:{position:"absolute",inset:0}},t))}function G({children:t}){const{camera:e}=b();return F(t,e)}function Q(t){const{xr:e}=t,[n,i]=l.exports.useState(()=>e.getSession());return l.exports.useEffect(()=>{const o=()=>i(e.getSession());return e.addEventListener("sessionstart",o),e.addEventListener("sessionend",o),()=>{e.removeEventListener("sessionstart",o),e.removeEventListener("sessionend",o)}},[e]),n}function h(t){const{gl:e}=b(),n=Q(e);l.exports.useEffect(()=>{n&&n.updateWorldSensingState({meshDetectionState:{enabled:!0}})},[n]),w((i,o)=>{const s=o.worldInformation;s.meshes&&s.meshes.forEach(a=>{a.changed&&t(a.blendShapes,a.modelMatrix)})})}function X(t){const[e]=l.exports.useState(()=>x(t));return e}const k=new d;function _(){const t=X("https://expressive-avatars-server.herokuapp.com");return h((e,n)=>{k.fromArray(n).multiply(u.matrixOffset),t.volatile.emit("face",{blendShapes:e,matrix:k.toArray()})}),null}new A;const E=new d;function $(){const t=l.exports.useRef();return h((e,n)=>{E.fromArray(n).multiply(u.matrixOffset),t.current.quaternion.setFromRotationMatrix(E)}),r("group",{"position-z":-4,children:c("mesh",{ref:t,children:[r("boxGeometry",{}),r("meshNormalMaterial",{})]})})}const u={needsCalibration:!1,matrixOffset:new d};function K(){const{rootEl:t,DomOverlay:e}=J();return c(B,{children:[c(D,{sessionInit:{requiredFeatures:["worldSensing","dom-overlay"],domOverlay:{root:t}},camera:{fov:35},children:[r(_,{}),r(U,{}),c(G,{children:[r($,{}),r("directionalLight",{position:3}),r("ambientLight",{intensity:.5})]})]}),r(e,{children:c("div",{style:{position:"absolute",inset:0},children:[r("div",{children:"Hello Overlay!"}),r("button",{onClick:()=>u.needsCalibration=!0,children:"Calibrate"})]})})]})}function U(){return h((t,e)=>{u.needsCalibration&&(u.matrixOffset.fromArray(e).invert(),u.needsCalibration=!1)}),null}function J(){const[t]=l.exports.useState(()=>{const n=document.createElement("div");return document.body.appendChild(n),n});function e({children:n}){return M.exports.createPortal(n,t)}return{rootEl:t,DomOverlay:e}}function V(){return c(I,{camera:{fov:35,position:[0,0,3]},children:[r("color",{attach:"background",args:["black"]}),c(l.exports.Suspense,{fallback:null,children:[r(T,{}),r(Z,{}),r(j,{preset:"warehouse",background:!0})]})]})}const Y="https://d1a370nemizbjq.cloudfront.net/54a8ca1e-1759-4cf9-ab76-bec155d6c83c.glb",O=new d;function Z(){const{scene:t,nodes:e}=q(Y),n=e.Wolf3D_Head,i=e.Wolf3D_Teeth,o=e.Head;return ee((s,a)=>{O.fromArray(a),o.quaternion.setFromRotationMatrix(O);for(let f in s){const p=n.morphTargetDictionary[f];n.morphTargetInfluences[p]=s[f],i.morphTargetInfluences[p]=s[f]}}),r("primitive",{object:t,position:[0,-2.4,0],scale:4})}function ee(t){l.exports.useEffect(()=>{const e=x("https://expressive-avatars-server.herokuapp.com"),n=()=>{console.log("connected to socket.io server")},i=({blendShapes:o,matrix:s})=>t(o,s);return e.on("connect",n),e.on("face",i),()=>{e.off("connect",n),e.off("face",i)}},[])}H.render(r(P.StrictMode,{children:r(N,{children:c(W,{children:[r(m,{path:"/",exact:!0,children:c("ul",{children:[r(S,{to:"/sender",children:r("li",{children:"Sender"})}),r(S,{to:"/receiver",children:r("li",{children:"Receiver"})})]})}),r(m,{path:"/receiver",children:r(V,{})}),r(m,{path:"/sender",children:r(K,{})})]})})}),document.getElementById("root"));
